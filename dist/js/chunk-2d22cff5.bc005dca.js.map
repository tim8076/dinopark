{"version":3,"sources":["webpack:///./src/views/backend/Coupon.vue","webpack:///./src/components/back/CouponModal.vue","webpack:///./src/components/back/CouponModal.vue?b611","webpack:///./src/views/backend/Coupon.vue?aa25"],"names":["class","scope","width","role","aria-label","active","isLoading","ref","temp-coupon","tempCoupon","updateCoupon","data-bs-target","type","openModal","text","color","coupons","coupon","key","id","title","code","percent","$dateFormat","due_date","is_enabled","deleteCoupon","pagination","getCoupons","tabindex","aria-labelledby","aria-hidden","data-bs-dismiss","for","placeholder","min","setDueDate","true-value","false-value","disabled","sendCoupon","props","Object","required","emits","mixins","Modal","data","modal","computed","this","watch","methods","e","date","target","value","timeStamp","Date","getTime","$emit","render","isNew","components","CouponModal","Pagination","$refs","couponModal","page","api","$http","get","then","res","success","swal","message","method","hideModal","swalComfirm","willDelete","isConfirmed","delete","mounted"],"mappings":"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","file":"js/chunk-2d22cff5.bc005dca.js","sourcesContent":["<template>\r\n     <div class=\"coupon__list fw-bold mb-6\">\r\n        <Loading v-model:active=\"isLoading\">\r\n                 <div class=\"loadingio-spinner-rolling-feeb69z48bi\">\r\n                  <div class=\"ldio-947txsafiul\">\r\n                    <div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n        </Loading>\r\n        <CouponModal ref=\"couponModal\"\r\n                     :temp-coupon=\"tempCoupon\"\r\n                     @send-coupon=\"updateCoupon\">\r\n        </CouponModal>\r\n        <div class=\"container p-5 border border-primary\">\r\n            <div class=\"d-flex justify-content-end align-items-center mb-3\">\r\n              <button class=\"btn btn-info\"\r\n                      data-bs-target=\"#couponModal\"\r\n                      type=\"button\"\r\n                      @click=\"openModal(true)\">\r\n                  建立優惠券\r\n              </button>\r\n            </div>\r\n            <Alert :text=\"'設定五折以下折扣，須經由園區主任簽核!!'\"\r\n                   :color=\"'primary'\">\r\n            </Alert>\r\n            <div class=\"table-responsive\">\r\n               <table class=\"table\">\r\n                  <thead>\r\n                      <tr class=\"table-light\">\r\n                          <th scope=\"col\" width=\"240\">優惠券名稱</th>\r\n                          <th scope=\"col\" width=\"120\">代碼</th>\r\n                          <th scope=\"col\" width=\"120\">折扣</th>\r\n                          <th scope=\"col\" width=\"120\">到期日</th>\r\n                          <th scope=\"col\" width=\"120\">是否啟用</th>\r\n                          <th scope=\"col\" width=\"120\">操作</th>\r\n                      </tr>\r\n                  </thead>\r\n                  <tbody>\r\n                      <tr v-for=\"coupon in coupons\" :key=\"coupon.id\">\r\n                          <td>{{ coupon.title }}</td>\r\n                          <td>{{ coupon.code }}</td>\r\n                          <td>{{ coupon.percent }}</td>\r\n                          <td>{{ $dateFormat(coupon.due_date) }}</td>\r\n                          <td>\r\n                            <p v-if=\"coupon.is_enabled\">啟用</p>\r\n                            <p v-else class=\"text-primary\">未啟用</p>\r\n                          </td>\r\n                          <td>\r\n                            <div class=\"btn-group\" role=\"group\" aria-label=\"Basic example\">\r\n                              <button type=\"button\"\r\n                                      class=\"btn btn-outline-info\"\r\n                                      @click.prevent=\"openModal(false, coupon)\">\r\n                                      編輯\r\n                              </button>\r\n                              <button type=\"button\"\r\n                                      class=\"btn btn-outline-danger\"\r\n                                      @click.prevent=\"deleteCoupon(coupon.id)\">\r\n                                      刪除\r\n                              </button>\r\n                            </div>\r\n                          </td>\r\n                      </tr>\r\n                  </tbody>\r\n              </table>\r\n            </div>\r\n            <Pagination :pagination=\"pagination\"\r\n                        @change-page=\"getCoupons\">\r\n            </Pagination>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport CouponModal from '@/components/back/CouponModal.vue'\r\nimport Pagination from '@/components/Pagination.vue'\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      isLoading: false,\r\n      tempCoupon: {},\r\n      coupons: [],\r\n      pagination: {},\r\n      isNew: false\r\n    }\r\n  },\r\n  components: {\r\n    CouponModal,\r\n    Pagination\r\n  },\r\n  methods: {\r\n    openModal (isNew, coupon) {\r\n      if (isNew) {\r\n        this.tempCoupon = {}\r\n      } else {\r\n        this.tempCoupon = { ...coupon }\r\n      }\r\n      this.isNew = isNew\r\n      this.$refs.couponModal.openModal()\r\n    },\r\n    getCoupons (page = 1) {\r\n      this.isLoading = true\r\n      const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`\r\n      this.$http.get(api)\r\n        .then(res => {\r\n          if (res.data.success) {\r\n            const { coupons, pagination } = res.data\r\n            this.coupons = coupons\r\n            this.pagination = pagination\r\n          } else {\r\n            this.swal(res.data.message, 'error')\r\n          }\r\n          this.isLoading = false\r\n        })\r\n    },\r\n    updateCoupon (coupon) {\r\n      this.isLoading = true\r\n      let api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon`\r\n      let method = 'post'\r\n      if (!this.isNew) {\r\n        api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${coupon.id}`\r\n        method = 'put'\r\n      }\r\n      this.$http[method](api, { data: coupon })\r\n        .then(res => {\r\n          if (res.data.success) {\r\n            this.$refs.couponModal.hideModal()\r\n            this.getCoupons()\r\n            this.swal(res.data.message)\r\n          } else {\r\n            this.swal(res.data.message, 'error')\r\n          }\r\n          this.isLoading = false\r\n        })\r\n    },\r\n    deleteCoupon (id) {\r\n      this.swalComfirm('確認刪除優惠券?')\r\n        .then(willDelete => {\r\n          if (willDelete.isConfirmed) {\r\n            this.isLoading = true\r\n            const api = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${id}`\r\n            this.$http.delete(api)\r\n              .then(res => {\r\n                if (res.data.success) {\r\n                  this.getCoupons()\r\n                  this.swal(res.data.message)\r\n                } else {\r\n                  this.swal(res.data.message, 'error')\r\n                }\r\n              })\r\n          }\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    this.getCoupons()\r\n  }\r\n}\r\n</script>\r\n","<template>\r\n  <div class=\"modal fade\"\r\n       id=\"couponModal\"\r\n       ref=\"modal\"\r\n       tabindex=\"-1\"\r\n       aria-labelledby=\"couponModal\"\r\n       aria-hidden=\"true\">\r\n    <div class=\"modal-dialog modal-lg\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header bg-secondary\">\r\n                <h5 class=\"modal-title\" id=\"exampleModalLabel\">建立優惠券</h5>\r\n                <button type=\"button\"\r\n                        class=\"btn-close\"\r\n                        data-bs-dismiss=\"modal\" aria-label=\"Close\">\r\n                </button>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n               <div class=\"container-fluid\">\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"title\" class=\"form-label\">\r\n                          優惠卷名稱 <span class=\"text-primary\">*</span>\r\n                        </label>\r\n                        <input type=\"text\"\r\n                               class=\"form-control\"\r\n                               id=\"title\"\r\n                               v-model.trim=\"coupon.title\"\r\n                               placeholder=\"請輸入名稱\">\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"code\" class=\"form-label\">\r\n                          優惠券代碼 <span class=\"text-primary\">*</span>\r\n                        </label>\r\n                        <input type=\"text\"\r\n                               class=\"form-control\"\r\n                               id=\"code\"\r\n                               v-model.trim=\"coupon.code\"\r\n                               placeholder=\"請輸入代碼\">\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"percent\" class=\"form-label\">\r\n                          折扣比率 <span class=\"text-primary\">*</span>\r\n                        </label>\r\n                        <input type=\"number\"\r\n                               class=\"form-control\"\r\n                               id=\"percent\"\r\n                               min=\"0\"\r\n                               v-model.number=\"coupon.percent\"\r\n                               placeholder=\"請輸入折扣比率 ex: 60\">\r\n                    </div>\r\n                    <div class=\"mb-3\">\r\n                        <label for=\"due_date\" class=\"form-label\">\r\n                          到期日 <span class=\"text-primary\">*</span>\r\n                        </label>\r\n                        <input type=\"date\"\r\n                               class=\"form-control\"\r\n                               id=\"due_date\"\r\n                               placeholder=\"請輸入到期日\"\r\n                               @change=\"setDueDate\">\r\n                    </div>\r\n                    <div class=\"form-check mb-3\">\r\n                        <input class=\"form-check-input\"\r\n                               type=\"checkbox\"\r\n                               v-model=\"coupon.is_enabled\"\r\n                               :true-value=\"1\"\r\n                               :false-value=\"0\"\r\n                               id=\"is_enabled\">\r\n                        <label class=\"form-check-label\" for=\"is_enabled\">\r\n                          是否啟用\r\n                        </label>\r\n                      </div>\r\n               </div>\r\n            </div>\r\n            <div class=\"modal-footer\">\r\n                <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">取消</button>\r\n                <button type=\"button\"\r\n                        class=\"btn btn-info\"\r\n                        :class=\"{ 'disabled' : disabled }\"\r\n                        @click=\"sendCoupon\">確認\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Modal from '../../mixins/Modal.vue'\r\nexport default {\r\n  props: {\r\n    tempCoupon: {\r\n      type: Object,\r\n      required: true\r\n    }\r\n  },\r\n  emits: ['send-coupon'],\r\n  mixins: [Modal],\r\n  data () {\r\n    return {\r\n      modal: {},\r\n      coupon: {}\r\n    }\r\n  },\r\n  computed: {\r\n    disabled () {\r\n      if (!this.coupon.title ||\r\n        !this.coupon.code ||\r\n        !this.coupon.percent ||\r\n        !this.coupon.due_date) {\r\n        return true\r\n      } else {\r\n        return false\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    tempCoupon () {\r\n      this.coupon = this.tempCoupon\r\n    }\r\n  },\r\n  methods: {\r\n    setDueDate (e) {\r\n      const date = e.target.value\r\n      const timeStamp = new Date(date).getTime() / 1000\r\n      this.coupon.due_date = timeStamp\r\n    },\r\n    sendCoupon () {\r\n      this.$emit('send-coupon', this.coupon)\r\n    }\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./CouponModal.vue?vue&type=template&id=4760307e\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupon.vue?vue&type=template&id=36d0c551\"\nimport script from \"./Coupon.vue?vue&type=script&lang=js\"\nexport * from \"./Coupon.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}