(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22cff5"],{f62a:function(e,t,o){"use strict";o.r(t);var c=o("7a23"),a={class:"coupon__list fw-bold mb-6"},n=Object(c["createVNode"])("div",{class:"loadingio-spinner-rolling-feeb69z48bi"},[Object(c["createVNode"])("div",{class:"ldio-947txsafiul"},[Object(c["createVNode"])("div")])],-1),i={class:"container p-5 border border-primary"},s={class:"d-flex justify-content-end align-items-center mb-3"},d={class:"table-responsive"},l={class:"table"},r=Object(c["createVNode"])("thead",null,[Object(c["createVNode"])("tr",{class:"table-light"},[Object(c["createVNode"])("th",{scope:"col",width:"240"},"優惠券名稱"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"代碼"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"折扣"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"到期日"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"是否啟用"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"操作")])],-1),u={key:0},p={key:1,class:"text-primary"},b={class:"btn-group",role:"group","aria-label":"Basic example"};function j(e,t,o,j,h,O){var m=Object(c["resolveComponent"])("Loading"),f=Object(c["resolveComponent"])("CouponModal"),V=Object(c["resolveComponent"])("Alert"),N=Object(c["resolveComponent"])("Pagination");return Object(c["openBlock"])(),Object(c["createBlock"])("div",a,[Object(c["createVNode"])(m,{active:h.isLoading,"onUpdate:active":t[1]||(t[1]=function(e){return h.isLoading=e})},{default:Object(c["withCtx"])((function(){return[n]})),_:1},8,["active"]),Object(c["createVNode"])(f,{ref:"couponModal","temp-coupon":h.tempCoupon,onSendCoupon:O.updateCoupon},null,8,["temp-coupon","onSendCoupon"]),Object(c["createVNode"])("div",i,[Object(c["createVNode"])("div",s,[Object(c["createVNode"])("button",{class:"btn btn-info","data-bs-target":"#couponModal",type:"button",onClick:t[2]||(t[2]=function(e){return O.openModal(!0)})}," 建立優惠券 ")]),Object(c["createVNode"])(V,{text:"設定五折以下折扣，須經由園區主任簽核!!",color:"primary"}),Object(c["createVNode"])("div",d,[Object(c["createVNode"])("table",l,[r,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(h.coupons,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:t.id},[Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.title),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.code),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(t.percent),1),Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.$dateFormat(t.due_date)),1),Object(c["createVNode"])("td",null,[t.is_enabled?(Object(c["openBlock"])(),Object(c["createBlock"])("p",u,"啟用")):(Object(c["openBlock"])(),Object(c["createBlock"])("p",p,"未啟用"))]),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("div",b,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-info",onClick:Object(c["withModifiers"])((function(e){return O.openModal(!1,t)}),["prevent"])}," 編輯 ",8,["onClick"]),Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-danger",onClick:Object(c["withModifiers"])((function(e){return O.deleteCoupon(t.id)}),["prevent"])}," 刪除 ",8,["onClick"])])])])})),128))])])]),Object(c["createVNode"])(N,{pagination:h.pagination,onChangePage:O.getCoupons},null,8,["pagination","onChangePage"])])])}o("99af");var h={class:"modal fade",id:"couponModal",ref:"couponModal",tabindex:"-1","aria-labelledby":"couponModal","aria-hidden":"true"},O={class:"modal-dialog modal-lg"},m={class:"modal-content"},f=Object(c["createVNode"])("div",{class:"modal-header bg-secondary"},[Object(c["createVNode"])("h5",{class:"modal-title",id:"exampleModalLabel"},"建立優惠券"),Object(c["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),V={class:"modal-body"},N={class:"container-fluid"},v={class:"mb-3"},g=Object(c["createVNode"])("label",{for:"title",class:"form-label"},[Object(c["createTextVNode"])(" 優惠卷名稱 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),C={class:"mb-3"},w=Object(c["createVNode"])("label",{for:"code",class:"form-label"},[Object(c["createTextVNode"])(" 優惠券代碼 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),y={class:"mb-3"},x=Object(c["createVNode"])("label",{for:"percent",class:"form-label"},[Object(c["createTextVNode"])(" 折扣比率 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),k={class:"mb-3"},M=Object(c["createVNode"])("label",{for:"due_date",class:"form-label"},[Object(c["createTextVNode"])(" 到期日 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),B={class:"form-check mb-3"},D=Object(c["createVNode"])("label",{class:"form-check-label",for:"is_enabled"},[Object(c["createTextVNode"])(" 是否啟用 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),$={class:"modal-footer"},_=Object(c["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function L(e,t,o,a,n,i){return Object(c["openBlock"])(),Object(c["createBlock"])("div",h,[Object(c["createVNode"])("div",O,[Object(c["createVNode"])("div",m,[f,Object(c["createVNode"])("div",V,[Object(c["createVNode"])("div",N,[Object(c["createVNode"])("div",v,[g,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[1]||(t[1]=function(e){return n.coupon.title=e}),placeholder:"請輸入名稱"},null,512),[[c["vModelText"],n.coupon.title,void 0,{trim:!0}]])]),Object(c["createVNode"])("div",C,[w,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"code","onUpdate:modelValue":t[2]||(t[2]=function(e){return n.coupon.code=e}),placeholder:"請輸入代碼"},null,512),[[c["vModelText"],n.coupon.code,void 0,{trim:!0}]])]),Object(c["createVNode"])("div",y,[x,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"number",class:"form-control",id:"percent","onUpdate:modelValue":t[3]||(t[3]=function(e){return n.coupon.percent=e}),placeholder:"請輸入折扣比率 ex: 60"},null,512),[[c["vModelText"],n.coupon.percent,void 0,{number:!0}]])]),Object(c["createVNode"])("div",k,[M,Object(c["createVNode"])("input",{type:"date",class:"form-control",id:"due_date",placeholder:"請輸入到期日",onChange:t[4]||(t[4]=function(){return i.setDueDate&&i.setDueDate.apply(i,arguments)})},null,32)]),Object(c["createVNode"])("div",B,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=function(e){return n.coupon.is_enabled=e}),"true-value":1,"false-value":0,id:"is_enabled"},null,512),[[c["vModelCheckbox"],n.coupon.is_enabled]]),D])])]),Object(c["createVNode"])("div",$,[_,Object(c["createVNode"])("button",{type:"button",class:["btn btn-info",{disabled:i.disabled}],onClick:t[6]||(t[6]=function(){return i.sendCoupon&&i.sendCoupon.apply(i,arguments)})},"確認 ",2)])])])],512)}var T=o("5530"),S=o("7c2b"),U=o.n(S),P={props:{tempCoupon:{type:Object,required:!0}},data:function(){return{modal:{},coupon:{}}},computed:{disabled:function(){return!(this.coupon.title&&this.coupon.code&&this.coupon.percent&&this.coupon.due_date)}},watch:{tempCoupon:function(){this.coupon=Object(T["a"])({},this.tempCoupon)}},methods:{openModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()},setDueDate:function(e){var t=e.target.value,o=new Date(t).getTime()/1e3;this.coupon.due_date=o},sendCoupon:function(){this.$emit("send-coupon",this.coupon)}},mounted:function(){this.modal=new U.a(this.$refs.couponModal)}};P.render=L;var F=P,J=o("1799"),q={data:function(){return{isLoading:!1,tempCoupon:{},coupons:[],pagination:{},isNew:!1}},components:{CouponModal:F,Pagination:J["a"]},methods:{openModal:function(e,t){this.tempCoupon=e?{}:t,this.isNew=e,this.$refs.couponModal.openModal()},getCoupons:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/coupons?page=").concat(t);this.$http.get(o).then((function(t){if(t.data.success){var o=t.data,c=o.coupons,a=o.pagination;e.coupons=c,e.pagination=a}else e.$swal({icon:"error",title:t.data.message,position:"top",showConfirmButton:!0});e.isLoading=!1}))},updateCoupon:function(e){var t=this;this.isLoading=!0;var o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/coupon"),c="post";this.isNew||(o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/coupon/").concat(e.id),c="put"),this.$http[c](o,{data:e}).then((function(e){e.data.success?(t.$refs.couponModal.hideModal(),t.getCoupons(),t.$swal({icon:"success",title:e.data.message,toast:!0,position:"top",showConfirmButton:!1,timer:1800})):t.$swal({icon:"error",title:e.data.message,position:"top",showConfirmButton:!0}),t.isLoading=!1}))},deleteCoupon:function(e){var t=this;this.$swal({title:"確認刪除 優惠券?",showConfirmButton:!0,showCancelButton:!0,reverseButtons:!0,icon:"warning"}).then((function(o){if(o.isConfirmed){t.isLoading=!0;var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/coupon/").concat(e);t.$http.delete(c).then((function(e){e.data.success?(t.getCoupons(),t.$swal({icon:"success",title:e.data.message,toast:!0,position:"top",showConfirmButton:!1,timer:1800})):t.$swal({icon:"error",title:e.data.message,position:"top",showConfirmButton:!0})}))}}))}},mounted:function(){this.getCoupons()}};q.render=j;t["default"]=q}}]);
//# sourceMappingURL=chunk-2d22cff5.408ee440.js.map