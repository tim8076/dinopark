(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1525d29a"],{"833b":function(e,t,a){"use strict";a.r(t);var c=a("7a23"),r={class:"article__list"},o=Object(c["createVNode"])("div",{class:"loadingio-spinner-rolling-feeb69z48bi"},[Object(c["createVNode"])("div",{class:"ldio-947txsafiul"},[Object(c["createVNode"])("div")])],-1),l={class:"container p-5 border border-primary"},i={class:"d-flex justify-content-end align-items-center mb-3"},n={class:"table-responsive"},s={class:"table"},d=Object(c["createVNode"])("thead",null,[Object(c["createVNode"])("tr",{class:"table-light"},[Object(c["createVNode"])("th",{scope:"col",width:"120"},"日期"),Object(c["createVNode"])("th",{scope:"col",width:"240"},"標題"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"標籤"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"公開"),Object(c["createVNode"])("th",{scope:"col",width:"120"},"操作")])],-1),b={scope:"row"},u={class:"text-primary"},p={class:"btn-group",role:"group"};function h(e,t,a,h,m,g){var j=Object(c["resolveComponent"])("Loading"),O=Object(c["resolveComponent"])("ArticleModal"),f=Object(c["resolveComponent"])("Alert"),V=Object(c["resolveComponent"])("Pagination");return Object(c["openBlock"])(),Object(c["createBlock"])("div",r,[Object(c["createVNode"])(j,{active:m.isLoading,"onUpdate:active":t[1]||(t[1]=function(e){return m.isLoading=e})},{default:Object(c["withCtx"])((function(){return[o]})),_:1},8,["active"]),Object(c["createVNode"])(O,{ref:"articleModal","temp-article":m.tempArticle,onSendArticle:g.updateArticle,isNew:m.isNew},null,8,["temp-article","onSendArticle","isNew"]),Object(c["createVNode"])("div",l,[Object(c["createVNode"])("div",i,[Object(c["createVNode"])("button",{class:"btn btn-info",type:"button",onClick:t[2]||(t[2]=function(e){return g.openModal(!0)})}," 建立文章 ")]),Object(c["createVNode"])(f,{text:"園區介紹文章請加上type:公園新聞",color:"success"}),Object(c["createVNode"])("div",n,[Object(c["createVNode"])("table",s,[d,Object(c["createVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(m.articles,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("tr",{key:t.id},[Object(c["createVNode"])("td",null,Object(c["toDisplayString"])(e.$dateFormat(t.create_at)),1),Object(c["createVNode"])("th",b,Object(c["toDisplayString"])(t.title),1),Object(c["createVNode"])("td",null,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(t.tag,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])("span",{key:e},Object(c["toDisplayString"])(e),1)})),128))]),Object(c["createVNode"])("td",null,[Object(c["withDirectives"])(Object(c["createVNode"])("span",null,"公開",512),[[c["vShow"],t.isPublic]]),Object(c["withDirectives"])(Object(c["createVNode"])("span",u," 非公開 ",512),[[c["vShow"],!1===t.isPublic]])]),Object(c["createVNode"])("td",null,[Object(c["createVNode"])("div",p,[Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-info",onClick:Object(c["withModifiers"])((function(e){return g.openModal(!1,t)}),["prevent"])}," 編輯 ",8,["onClick"]),Object(c["createVNode"])("button",{type:"button",class:"btn btn-outline-danger",onClick:Object(c["withModifiers"])((function(e){return g.deleteArticle(t.id)}),["prevent"])}," 刪除 ",8,["onClick"])])])])})),128))])])]),Object(c["createVNode"])(V,{pagination:m.pagination,onChangePage:g.getArticles},null,8,["pagination","onChangePage"])])])}a("99af");var m={class:"modal fade",id:"articleModal",tabindex:"-1",ref:"modal"},g={class:"modal-dialog modal-xl"},j={class:"modal-content"},O={class:"modal-header"},f={class:"modal-title",id:"exampleModalLabel"},V=Object(c["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),N={class:"modal-body"},v={class:"container-fluid"},k={class:"row"},y={class:"col-lg-4"},w={class:"mb-3"},x=Object(c["createVNode"])("label",{for:"imgUrl",class:"form-label"},"圖片網址",-1),B=Object(c["createVNode"])("label",{for:"imgUpload",class:"form-label"},"上傳主要文章圖片",-1),A={key:1,class:"d-flex\r\n                                    justify-content-center\r\n                                    align-items-center",style:{height:"200px"}},M=Object(c["createVNode"])("div",{class:"spinner-border text-primary",style:{width:"3rem",height:"3rem"},role:"status"},[Object(c["createVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),T={class:"col-lg-8"},C={class:"mb-3"},L=Object(c["createVNode"])("label",{for:"title",class:"form-label"},[Object(c["createTextVNode"])(" 文章標題 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),D={class:"row"},P={class:"col-md-6"},U={class:"mb-3"},I=Object(c["createVNode"])("label",{for:"author",class:"form-label"},[Object(c["createTextVNode"])(" 作者 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),$={class:"col-md-6"},S={class:"mb-3"},_=Object(c["createVNode"])("label",{for:"create_at",class:"form-label"},[Object(c["createTextVNode"])(" 文章日期 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),F={class:"mb-3"},J=Object(c["createVNode"])("label",{class:"form-label"}," 文章標籤 ",-1),Y={class:"row"},q=Object(c["createVNode"])("hr",null,null,-1),z={class:"mb-3"},E=Object(c["createVNode"])("label",{class:"form-label",for:"mainArticle"},[Object(c["createTextVNode"])(" 輸入主文內容 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),G={class:"mb-3 mt-3"},H={class:"row mb-3"},K={class:"col-lg-4 mb-md-3"},Q=Object(c["createVNode"])("label",{class:"form-label",for:"paraImage"}," 上傳段落圖片 ",-1),R={class:"col-lg-8 mb-md-3"},W=Object(c["createVNode"])("label",{class:"form-label",for:"paraTitle"}," 輸入段落標題 ",-1),X=Object(c["createVNode"])("label",{class:"form-label",for:"paraText"}," 輸入段落文字 ",-1),Z=Object(c["createVNode"])("hr",null,null,-1),ee={class:"form-check mb-3"},te=Object(c["createVNode"])("label",{class:"form-check-label",for:"isPublic"},[Object(c["createTextVNode"])(" 文章是否公開 "),Object(c["createVNode"])("span",{class:"text-primary"},"*")],-1),ae={class:"modal-footer"},ce=Object(c["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function re(e,t,a,r,o,l){return Object(c["openBlock"])(),Object(c["createBlock"])("div",m,[Object(c["createVNode"])("div",g,[Object(c["createVNode"])("div",j,[Object(c["createVNode"])("div",O,[Object(c["createVNode"])("h5",f,Object(c["toDisplayString"])(l.modalTitle),1),V]),Object(c["createVNode"])("div",N,[Object(c["createVNode"])("div",v,[Object(c["createVNode"])("div",k,[Object(c["createVNode"])("div",y,[Object(c["createVNode"])("div",w,[x,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control mb-3",id:"imgUrl","onUpdate:modelValue":t[1]||(t[1]=function(e){return o.article.image=e}),placeholder:"請輸入圖片網址"},null,512),[[c["vModelText"],o.article.image,void 0,{trim:!0}]]),B,Object(c["createVNode"])("input",{type:"file",class:"form-control mb-5",id:"imgUpload",onChange:t[2]||(t[2]=function(e){return l.upLoadImage(null,e)})},null,32),o.isLoading?(Object(c["openBlock"])(),Object(c["createBlock"])("div",A,[M])):(Object(c["openBlock"])(),Object(c["createBlock"])("img",{key:0,class:"img-fluid mb-3",src:o.article.image},null,8,["src"]))])]),Object(c["createVNode"])("div",T,[Object(c["createVNode"])("div",C,[L,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[3]||(t[3]=function(e){return o.article.title=e}),placeholder:"請輸入標題"},null,512),[[c["vModelText"],o.article.title,void 0,{trim:!0}]])]),Object(c["createVNode"])("div",D,[Object(c["createVNode"])("div",P,[Object(c["createVNode"])("div",U,[I,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control",id:"author","onUpdate:modelValue":t[4]||(t[4]=function(e){return o.article.author=e}),placeholder:"請輸入作者"},null,512),[[c["vModelText"],o.article.author,void 0,{trim:!0}]])])]),Object(c["createVNode"])("div",$,[Object(c["createVNode"])("div",S,[_,Object(c["createVNode"])("input",{type:"date",class:"form-control",id:"create_at",placeholder:"請輸入文章日期",value:e.$dateYYYYMMDD(this.article.create_at),onChange:t[5]||(t[5]=function(){return l.setArticleDate&&l.setArticleDate.apply(l,arguments)})},null,40,["value"])])])]),Object(c["createVNode"])("div",F,[J,Object(c["createVNode"])("div",Y,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(o.article.tag,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:"col-md-4 mb-3",key:t},[Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",class:"form-control","onUpdate:modelValue":function(e){return o.article.tag[t]=e},placeholder:"輸入標籤"},null,8,["onUpdate:modelValue"]),[[c["vModelText"],o.article.tag[t],void 0,{trim:!0}]])])})),128))]),o.article.tag[o.article.tag.length-1]||1===o.article.tag.length?(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:0,class:"btn btn-info me-3",onClick:t[6]||(t[6]=function(){return l.addTagInput&&l.addTagInput.apply(l,arguments)})}," 新增標籤欄位 ")):(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:1,class:"btn btn-outline-primary",onClick:t[7]||(t[7]=function(){return l.deleteTagInput&&l.deleteTagInput.apply(l,arguments)})}," 刪除標籤欄位 "))]),q,Object(c["createVNode"])("div",z,[E,Object(c["withDirectives"])(Object(c["createVNode"])("textarea",{id:"mainArticle",class:"form-control",rows:"8","onUpdate:modelValue":t[8]||(t[8]=function(e){return o.article.content=e})},"\r\n                                    ",512),[[c["vModelText"],o.article.content]])]),Object(c["createVNode"])("div",G,[Object(c["createVNode"])("div",H,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(o.article.paragraph,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],{key:e},[Object(c["createVNode"])("div",K,[Q,Object(c["createVNode"])("input",{type:"file",id:"paraImage",class:"form-control mb-3",onChange:function(e){return l.upLoadImage(t,e)}},null,40,["onChange"]),Object(c["createVNode"])("img",{class:"img-fluid mb-3",src:o.article.paragraph[t].image},null,8,["src"])]),Object(c["createVNode"])("div",R,[W,Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",id:"paraTitle",class:"form-control mb-3","onUpdate:modelValue":function(e){return o.article.paragraph[t].title=e}},null,8,["onUpdate:modelValue"]),[[c["vModelText"],o.article.paragraph[t].title]]),X,Object(c["withDirectives"])(Object(c["createVNode"])("textarea",{id:"paraText",class:"form-control",rows:"8","onUpdate:modelValue":function(e){return o.article.paragraph[t].content=e}},"\r\n                                                ",8,["onUpdate:modelValue"]),[[c["vModelText"],o.article.paragraph[t].content]])])],64)})),128))]),o.article.paragraph[o.article.paragraph.length-1].content||1===o.article.paragraph.length?(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:0,class:"btn btn-info w-25 me-3",onClick:t[9]||(t[9]=function(){return l.addParagraph&&l.addParagraph.apply(l,arguments)})}," 新增段落 ")):(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:1,class:"btn btn-outline-primary w-25",onClick:t[10]||(t[10]=function(){return l.deleteParagraph&&l.deleteParagraph.apply(l,arguments)})}," 刪除段落 ")),Z,Object(c["createVNode"])("div",ee,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=function(e){return o.article.isPublic=e}),id:"isPublic"},null,512),[[c["vModelCheckbox"],o.article.isPublic]]),te])])])])])]),Object(c["createVNode"])("div",ae,[ce,Object(c["createVNode"])("button",{type:"button",class:["btn btn-info",{disabled:l.disabled}],onClick:t[12]||(t[12]=function(){return l.sendArticle&&l.sendArticle.apply(l,arguments)})}," 確認 ",2)])])])],512)}a("a434");var oe=a("8a62"),le={props:{tempArticle:{type:Object,required:!0},isNew:{type:Boolean,required:!0}},emits:["send-article"],data:function(){return{isLoading:!1,article:{tag:[""],paragraph:[{image:"",title:"",content:""}],isPublic:!1}}},mixins:[oe["a"]],watch:{tempArticle:function(){this.article=this.tempArticle}},computed:{modalTitle:function(){return this.isNew?"新增文章":"編輯文章"},disabled:function(){return!(this.article.title&&this.article.create_at&&this.article.author&&this.article.content)}},methods:{setArticleDate:function(e){var t=e.target.value,a=new Date(t).getTime()/1e3;this.article.create_at=a},upLoadImage:function(e,t){var a=this;this.isLoading=!0;var c=t.target.files[0],r=new FormData;r.append("file-to-upload",c);var o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/upload");this.$http.post(o,r).then((function(t){t.data.success?(null===e?a.article.image=t.data.imageUrl:a.article.paragraph[e].image=t.data.imageUrl,a.swal("成功上傳圖片")):a.swal(t.data.message,"error"),a.isLoading=!1})).catch((function(e){return console.log(e)}))},addTagInput:function(){this.article.tag.push("")},deleteTagInput:function(){var e=this.article.tag.length-1;e>=1&&this.article.tag.splice(e,1)},addParagraph:function(){this.article.paragraph.push({image:"",title:"",content:""})},deleteParagraph:function(){var e=this.article.paragraph.length-1;this.article.paragraph.splice(e,1)},sendArticle:function(){this.$emit("send-article",this.article)}}};le.render=re;var ie=le,ne=a("1799"),se={data:function(){return{articles:[],tempArticle:{tag:[""],paragraph:[{image:"",title:"",content:""}],isPublic:!1},pagination:{},isNew:!1,isLoading:!1}},components:{ArticleModal:ie,Pagination:ne["a"]},methods:{openModal:function(e,t){e?(this.tempArticle={tag:[""],paragraph:[{image:"",title:"",content:""}],isPublic:!1},this.$refs.articleModal.openModal()):this.getArticle(t.id),this.isNew=e},getArticle:function(e){var t=this;this.isLoading=!0;var a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/article/").concat(e);this.$http.get(a).then((function(e){e.data.success?(t.tempArticle=JSON.parse(JSON.stringify(e.data.article)),t.$refs.articleModal.openModal()):t.swal(e.data.messages,"error"),t.isLoading=!1})).catch((function(e){return console.log(e)}))},getArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isLoading=!0;var a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/articles?page=").concat(t);this.$http.get(a).then((function(t){if(t.data.success){var a=t.data,c=a.articles,r=a.pagination;e.articles=c,e.pagination=r}else e.swal(t.data.messages,"error");e.isLoading=!1})).catch((function(e){return console.log(e)}))},updateArticle:function(e){var t=this;this.isLoading=!0;var a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/article"),c="post";this.isNew||(a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/article/").concat(e.id),c="put"),this.$http[c](a,{data:e}).then((function(e){e.data.success?(t.swal(e.data.message),t.$refs.articleModal.hideModal(),t.getArticles()):t.swal(e.data.message,"error"),t.isLoading=!1})).catch((function(e){return console.log(e)}))},deleteArticle:function(e){var t=this;this.swalComfirm("確認刪除文章?").then((function(a){if(a.isConfirmed){t.isLoading=!0;var c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("jurassic","/admin/article/").concat(e);t.$http.delete(c).then((function(e){e.data.success?(t.getArticles(),t.swal(e.data.message)):t.swal(e.data.message,"error"),t.isLoading=!1}))}})).catch((function(e){return console.log(e)}))}},created:function(){this.getArticles()}};se.render=h;t["default"]=se},a434:function(e,t,a){"use strict";var c=a("23e7"),r=a("23cb"),o=a("a691"),l=a("50c4"),i=a("7b0b"),n=a("65f0"),s=a("8418"),d=a("1dde"),b=d("splice"),u=Math.max,p=Math.min,h=9007199254740991,m="Maximum allowed length exceeded";c({target:"Array",proto:!0,forced:!b},{splice:function(e,t){var a,c,d,b,g,j,O=i(this),f=l(O.length),V=r(e,f),N=arguments.length;if(0===N?a=c=0:1===N?(a=0,c=f-V):(a=N-2,c=p(u(o(t),0),f-V)),f+a-c>h)throw TypeError(m);for(d=n(O,c),b=0;b<c;b++)g=V+b,g in O&&s(d,b,O[g]);if(d.length=c,a<c){for(b=V;b<f-c;b++)g=b+c,j=b+a,g in O?O[j]=O[g]:delete O[j];for(b=f;b>f-c+a;b--)delete O[b-1]}else if(a>c)for(b=f-c;b>V;b--)g=b+c-1,j=b+a-1,g in O?O[j]=O[g]:delete O[j];for(b=0;b<a;b++)O[b+V]=arguments[b+2];return O.length=f-c+a,d}})}}]);
//# sourceMappingURL=chunk-1525d29a.5cca01f0.js.map